# 模块设计

Aolarhapsody 采用模块化设计思想,将功能划分为独立的模块,便于开发、维护和扩展.

## 设计原则

### 高内聚低耦合

每个模块都有明确的职责边界,模块内部高度相关,模块之间依赖关系清晰.

### 可插拔性

模块设计为可插拔形式,可以根据需要启用或禁用特定功能模块.

### 可复用性

模块设计考虑通用性,便于在不同场景下复用.

## 模块结构

### 前端模块

```
frontend/src/
├── components/     # 通用组件
├── views/          # 页面视图
├── store/          # 状态管理
├── hooks/          # 自定义Hooks
├── utils/          # 工具函数
├── router/         # 路由配置
├── contexts/       # 上下文
├── theme/          # 主题配置
└── types/          # 类型定义
```

### 后端模块

```
backend/
├── routes/         # 路由处理
├── dataparse/      # 数据解析
├── types/          # 类型定义
└── utils/          # 工具函数
```

### 数据模块

- 宠物数据模块
- 物品数据模块
- 技能数据模块
- 图鉴数据模块
- 活动数据模块

## 模块间通信

### 前后端通信

使用RESTful API进行前后端通信,通过Axios发送HTTP请求.

### 组件间通信

- Props传递：父子组件间数据传递
- Context：跨层级组件状态共享
- Zustand：全局状态管理

### 模块依赖管理

使用pnpm workspace管理模块依赖,确保依赖版本一致性.

## 扩展性设计

### 新增数据模块

1. 在backend/dataparse目录下创建数据解析模块
2. 在backend/routes目录下创建对应路由处理
3. 在backend/types目录下定义数据类型
4. 在frontend/src/types目录下同步类型定义
5. 在前端创建对应的数据展示页面

### 新增功能模块

1. 在frontend/src/views目录下创建页面组件
2. 在frontend/src/components目录下创建相关组件
3. 在frontend/src/router目录下配置路由
4. 如需要后端支持,在backend/routes目录下创建对应接口

模块化设计使Aolarhapsody具有良好的可维护性和可扩展性,能够适应不断变化的需求.

# 模块化设计

Aolarhapsody 采用模块化设计原则,将功能划分为独立的模块,每个模块都有明确的职责和接口,便于维护和扩展.

## 设计原则

### 高内聚低耦合

每个模块内部高度内聚,专注于完成特定的功能,同时模块之间保持低耦合,减少相互依赖.

### 单一职责原则

每个模块只负责一个功能领域,确保模块的职责清晰明确.

### 开闭原则

模块对扩展开放,对修改关闭,通过扩展而非修改来增加新功能.

## 模块划分

### 1. 前端模块 (frontend/)

前端模块是用户直接交互的界面,负责数据展示和用户操作.

主要功能包括：

- 数据可视化展示
- 用户交互处理
- 主题切换支持
- 国际化支持
- 响应式设计

目录结构：

```
frontend/
├── src/
│   ├── components/     # 公共组件
│   ├── views/          # 页面视图
│   ├── hooks/          # 自定义 Hooks
│   ├── store/          # 状态管理
│   ├── utils/          # 工具函数
│   ├── router/         # 路由配置
│   ├── theme/          # 主题配置
│   └── locales/        # 国际化资源
├── public/             # 静态资源
└── package.json        # 前端依赖配置
```

### 2. 后端模块 (backend/)

后端模块负责数据处理和 API 服务提供,是整个应用的数据中枢.

主要功能包括：

- 游戏数据解析
- RESTful API 提供
- 数据处理和转换
- 跨域支持

目录结构：

```
backend/
├── dataparse/          # 数据解析模块
├── routes/             # API 路由
├── types/              # TypeScript 类型定义
├── index.ts            # 应用入口
├── Dockerfile          # Docker 配置
└── package.json        # 后端依赖配置
```

### 3. 脚本工具模块 (scripts/)

脚本工具模块包含项目开发和部署所需的各类工具.

目录结构：

```
scripts/
├── ash/                # 辅助脚本工具
├── turbo-run/          # 交互式脚本运行器
├── deploy/             # 部署相关脚本
└── clean.mjs           # 清理脚本
```

## 模块间通信

### 前后端交互

前端通过 HTTP 请求与后端进行通信,采用 RESTful API 设计规范：

```
┌──────────┐      HTTP     ┌──────────┐
│ Frontend │ ────────────→ │ Backend  │
│ (React)  │ ←──────────── │ (Node.js)│
└──────────┘   JSON Data   └──────────┘
```

### 数据处理流程

1. 原始游戏数据文件(XML 格式)
2. 后端数据解析模块处理
3. 转换为结构化数据存储在内存中
4. 通过 RESTful API 提供给前端
5. 前端接收数据并进行展示

## 模块扩展性

### 微服务准备

当业务复杂度增加时,可以将后端模块拆分为独立的微服务：

```
┌─────────────────┐    ┌─────────────────┐
│   API Gateway   │    │  Load Balancer  │
├─────────────────┤    ├─────────────────┤
│  User Service   │    │  Data Service   │
│                 │    │                 │
│  Auth Service   │    │  Cache Service  │
└─────────────────┘    └─────────────────┘
```
